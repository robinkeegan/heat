
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>mylib package &#8212; mylib 0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="License" href="license.html" />
    <link rel="prev" title="mylib" href="modules.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="license.html" title="License"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="modules.html" title="mylib"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mylib 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" accesskey="U">mylib</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mylib-package">
<h1>mylib package<a class="headerlink" href="#mylib-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mylib.heat_transport">
<span id="mylib-heat-transport-module"></span><h2>mylib.heat_transport module<a class="headerlink" href="#module-mylib.heat_transport" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mylib.heat_transport.NumericalTransport">
<em class="property">class </em><code class="descclassname">mylib.heat_transport.</code><code class="descname">NumericalTransport</code><a class="headerlink" href="#mylib.heat_transport.NumericalTransport" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="mylib.heat_transport.NumericalTransport.equation">
<code class="descname">equation</code><span class="sig-paren">(</span><em>T</em>, <em>z</em>, <em>dt</em>, <em>q</em>, <em>PwCw</em>, <em>pc</em>, <em>Ke</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.heat_transport.NumericalTransport.equation" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>T</strong> – </li>
<li><strong>z</strong> – </li>
<li><strong>dt</strong> – </li>
<li><strong>q</strong> – </li>
<li><strong>PwCw</strong> – </li>
<li><strong>pc</strong> – </li>
<li><strong>Ke</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mylib.heat_transport.NumericalTransport.numerical_model">
<code class="descname">numerical_model</code><span class="sig-paren">(</span><em>T</em>, <em>z</em>, <em>dt</em>, <em>q</em>, <em>PwCw</em>, <em>pc</em>, <em>Ke</em>, <em>n_iterations</em>, <em>top_bc</em>, <em>bot_bc</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.heat_transport.NumericalTransport.numerical_model" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>T</strong> – </li>
<li><strong>z</strong> – </li>
<li><strong>dt</strong> – </li>
<li><strong>q</strong> – </li>
<li><strong>PwCw</strong> – </li>
<li><strong>pc</strong> – </li>
<li><strong>Ke</strong> – </li>
<li><strong>n_iterations</strong> – </li>
<li><strong>top_bc</strong> – </li>
<li><strong>bot_bc</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mylib.heat_transport.NumericalTransport.objective">
<code class="descname">objective</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mylib.heat_transport.NumericalTransport.objective" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mylib.heat_transport.NumericalTransport.optimise">
<code class="descname">optimise</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mylib.heat_transport.NumericalTransport.optimise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="mylib.heat_transport.Stallman">
<em class="property">class </em><code class="descclassname">mylib.heat_transport.</code><code class="descname">Stallman</code><a class="headerlink" href="#mylib.heat_transport.Stallman" title="Permalink to this definition">¶</a></dt>
<dd><p>The Stallman model class has the option to calculate the Stallman constants or run the Stallman equation.</p>
<dl class="method">
<dt id="mylib.heat_transport.Stallman.constants">
<code class="descname">constants</code><span class="sig-paren">(</span><em>PsCs</em>, <em>PwCw</em>, <em>T</em>, <em>k</em>, <em>ne</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.heat_transport.Stallman.constants" title="Permalink to this definition">¶</a></dt>
<dd><p>Stallman Constants for the Stallman (1965) Heat Transport equation</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>q</strong> – groundwater flux positive downwards (m/s)</li>
<li><strong>PsCs</strong> – Volumetric heat capacity of the matrix (J/m3 C)</li>
<li><strong>PwCw</strong> – Volumetric heat capacity of water (J/m3 C)</li>
<li><strong>T</strong> – Period of oscillation (s)</li>
<li><strong>k</strong> – Thermal conductivity (W/m/C)</li>
<li><strong>ne</strong> – effective porosity (unit-less)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list with the stallman constants a and b as the zero’th and first elements.</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed using the equations:</p>
<div class="math notranslate nohighlight">
\[pc = n_e \cdot P_wC_w + (1 - n_e) \cdot P_sC_s\]</div>
<div class="math notranslate nohighlight">
\[C = \frac{\pi \cdot pc}{k \cdot T}\]</div>
<div class="math notranslate nohighlight">
\[D = \frac{-q \cdot C_wP_w}{2 \cdot k}\]</div>
<p>and A and B are constants calculated from C &amp; D via the following equations:</p>
<div class="math notranslate nohighlight">
\[a = ((C^2 + \frac{D^4}{4})^{1/2} + \frac{D^2}{2}) ^{1/2} - D\]</div>
<div class="math notranslate nohighlight">
\[b = ((C^2 + \frac{D^4}{4})^{1/2} - \frac{D^2}{2}) ^{1/2}\]</div>
</dd></dl>

<dl class="method">
<dt id="mylib.heat_transport.Stallman.stallman">
<code class="descname">stallman</code><span class="sig-paren">(</span><em>a</em>, <em>z</em>, <em>b</em>, <em>t</em>, <em>T</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.heat_transport.Stallman.stallman" title="Permalink to this definition">¶</a></dt>
<dd><p>The Stallman (1965) heat transport equation</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dT</strong> – The amplitude of the oscillation at z=0 (C)</li>
<li><strong>a</strong> – Stallman constant ‘a’ from function ‘stallman_cons’</li>
<li><strong>z</strong> – Positive depth below surface where z &gt; 0 and z &lt; infinity.</li>
<li><strong>b</strong> – Stallman constant ‘b’ from function ‘stallman_cons’</li>
<li><strong>t</strong> – Time/s for evaluation can be a value or a numpy array (s)</li>
<li><strong>T</strong> – Period of oscillation (s)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An amplitude at depth</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed using the equation:</p>
<div class="math notranslate nohighlight">
\[T-T_o = \Delta T \cdot e^{-a \cdot z} sin(\frac{2 \cdot \pi \cdot t}{T} - b \cdot z)\]</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mylib.heat_transport.b_p">
<em class="property">class </em><code class="descclassname">mylib.heat_transport.</code><code class="descname">b_p</code><a class="headerlink" href="#mylib.heat_transport.b_p" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="mylib.heat_transport.b_p.equation">
<code class="descname">equation</code><span class="sig-paren">(</span><em>q</em>, <em>PwCw</em>, <em>L</em>, <em>k</em>, <em>To</em>, <em>Tl</em>, <em>z</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.heat_transport.b_p.equation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bredehoeft and Papaopulos (1965) solution for one dimensional steady state heat transport.</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> – depth (m)</li>
<li><strong>L</strong> – maximum depth (m)</li>
<li><strong>To</strong> – temperature at z = 0 (C)</li>
<li><strong>Tl</strong> – temperature at z = L (C)</li>
<li><strong>q</strong> – groundwater flux positive downwards (m/s)</li>
<li><strong>PwCw</strong> – volumetric heat capacity of water (J/m3C)</li>
<li><strong>k</strong> – thermal conductivity (W/m/C)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns T(z):</th><td class="field-body"><p class="first last">The temperature at z.</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed using the equation:</p>
<div class="math notranslate nohighlight">
\[T(z) = To+(Tl-To)(\frac{e^{Ph\frac{z}{L}}-1}{e^{Ph}-1})\]</div>
<p>Where:</p>
<ul class="simple">
<li>z = depth (m)</li>
<li>L = maximum depth (m)</li>
<li>To = temperature at z = 0 (C)</li>
<li>Tl = temperature at z = L (C)</li>
<li>q = q in the z direction (m/s)</li>
<li>PwCw = volumetric heat capacity of water (J/m3C)</li>
<li>k = thermal conductivity (W/m/C)</li>
</ul>
<p>and:</p>
<div class="math notranslate nohighlight">
\[Ph = \frac{PwCwqzwL}{k}\]</div>
</dd></dl>

<dl class="method">
<dt id="mylib.heat_transport.b_p.objective">
<code class="descname">objective</code><span class="sig-paren">(</span><em>q</em>, <em>PwCw</em>, <em>L</em>, <em>k</em>, <em>To</em>, <em>Tl</em>, <em>z</em>, <em>T</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.heat_transport.b_p.objective" title="Permalink to this definition">¶</a></dt>
<dd><p>An objective function which calculates the absolute error between a modelled and observed profile for a flux
estimate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>q</strong> – groundwater flux positive downwards (m/s)</li>
<li><strong>PwCw</strong> – volumetric heat capacity of water (J/m3C)</li>
<li><strong>L</strong> – maximum depth (m)</li>
<li><strong>k</strong> – thermal conductivity (W/m/C)</li>
<li><strong>To</strong> – temperature at z = 0 (C)</li>
<li><strong>Tl</strong> – temperature at z = L (C)</li>
<li><strong>z</strong> – depth (m)</li>
<li><strong>T</strong> – temperature at z (C)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">absolute error between modelled T(z) and observed T at z.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mylib.heat_transport.b_p.optimise">
<code class="descname">optimise</code><span class="sig-paren">(</span><em>PwCw</em>, <em>L</em>, <em>k</em>, <em>To</em>, <em>Tl</em>, <em>z</em>, <em>T</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.heat_transport.b_p.optimise" title="Permalink to this definition">¶</a></dt>
<dd><p>When q is unknown this function will estimate optimal q value for a given profile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>PwCw</strong> – volumetric heat capacity of water (J/m3C)</li>
<li><strong>L</strong> – maximum depth (m)</li>
<li><strong>k</strong> – thermal conductivity (W/m/C)</li>
<li><strong>To</strong> – temperature at z = 0 (C)</li>
<li><strong>Tl</strong> – temperature at z = L (C)</li>
<li><strong>z</strong> – depth (m)</li>
<li><strong>T</strong> – temperature at z (C)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">an estimate of q</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="mylib.heat_transport.briggs_extinction_depth">
<code class="descclassname">mylib.heat_transport.</code><code class="descname">briggs_extinction_depth</code><span class="sig-paren">(</span><em>ke</em>, <em>Am</em>, <em>Ao</em>, <em>a</em>, <em>vt</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.heat_transport.briggs_extinction_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Brigg et al. (2014) method to calculate amplitude extinction depth for a sensor of finite precision.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ke</strong> – effective thermal conductivity (W/m C)</li>
<li><strong>Am</strong> – minimum detectable amplitude for sensor precision (C)</li>
<li><strong>Ao</strong> – amplitude of the signal at surface (C)</li>
<li><strong>a</strong> – Hatch alpha term (see hydro_funcs)</li>
<li><strong>vt</strong> – thermal front velocity (see hydro_funcs)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Ze the extinction depth at which amplitude oscillations will be undetectable to a sensor of finite precision</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed using the equation:</p>
<div class="math notranslate nohighlight">
\[Z_e = 2 \cdot K_e (\frac{\ln(A_{min}/A_{z=0})}{v_t - \sqrt{a + v_t^2 / 2}})\]</div>
</dd></dl>

</div>
<div class="section" id="module-mylib.hydro_funcs">
<span id="mylib-hydro-funcs-module"></span><h2>mylib.hydro_funcs module<a class="headerlink" href="#module-mylib.hydro_funcs" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mylib.hydro_funcs.hatch_alpha">
<code class="descclassname">mylib.hydro_funcs.</code><code class="descname">hatch_alpha</code><span class="sig-paren">(</span><em>vt</em>, <em>ke</em>, <em>T</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.hydro_funcs.hatch_alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>The Alpha (a) term used in Hatch et al (2006) amplitude and Briggs et al (2014) extinction depth model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vt</strong> – vt the thermal front velocity</li>
<li><strong>ke</strong> – ke the effective thermal conductivity (W/m C)</li>
<li><strong>T</strong> – period of oscillation (s)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a Hatch Alpha</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed with the equation:</p>
<div class="math notranslate nohighlight">
\[a = \sqrt{v_t^4 + (8 \pi \cdot k_e/ T)^2}\]</div>
</dd></dl>

<dl class="function">
<dt id="mylib.hydro_funcs.ke_">
<code class="descclassname">mylib.hydro_funcs.</code><code class="descname">ke_</code><span class="sig-paren">(</span><em>Kw</em>, <em>Ks</em>, <em>ne</em>, <em>pc</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.hydro_funcs.ke_" title="Permalink to this definition">¶</a></dt>
<dd><p>Effective thermal conductivity</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Kw</strong> – thermal conductivity of water (W/m C)</li>
<li><strong>Ks</strong> – thermal conductivity of solids (W/m C)</li>
<li><strong>ne</strong> – effective porosity (unit-less)</li>
<li><strong>pc</strong> – bulk volumetric heat capacity of a saturated medium (J/m3C)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ke the effective thermal conductivity (W/m C)</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed with the equation:</p>
<div class="math notranslate nohighlight">
\[k_e = \frac{k_w^{ne} \cdot k_s ^{(1-ne)}}{pc}\]</div>
</dd></dl>

<dl class="function">
<dt id="mylib.hydro_funcs.ke_full">
<code class="descclassname">mylib.hydro_funcs.</code><code class="descname">ke_full</code><span class="sig-paren">(</span><em>Kw</em>, <em>Ks</em>, <em>ne</em>, <em>PwCw</em>, <em>PsCs</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.hydro_funcs.ke_full" title="Permalink to this definition">¶</a></dt>
<dd><p>The effective thermal conductivity without intermediately calculating bulk volumetric heat capacity of a saturated medium</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Kw</strong> – thermal conductivity of water (W/m C)</li>
<li><strong>Ks</strong> – thermal conductivity of solids (W/m C)</li>
<li><strong>ne</strong> – effective porosity (unit-less)</li>
<li><strong>PwCw</strong> – volumetric heat capacity of water (J/m3C)</li>
<li><strong>PsCs</strong> – volumetric heat capacity of solid (J/m3C)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ke the effective thermal conductivity (W/m C)</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed with the equations:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[pc = n_e \cdot P_wC_w + (1 - n_e) \cdot P_sC_s\]</div>
<div class="math notranslate nohighlight">
\[k_e = \frac{k_w^{ne} \cdot k_s ^{(1-ne)}}{pc}\]</div>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="mylib.hydro_funcs.pc_">
<code class="descclassname">mylib.hydro_funcs.</code><code class="descname">pc_</code><span class="sig-paren">(</span><em>ne</em>, <em>PwCw</em>, <em>PsCs</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.hydro_funcs.pc_" title="Permalink to this definition">¶</a></dt>
<dd><p>Bulk volumetric heat capacity of a saturated medium</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ne</strong> – effective porosity (unit-less)</li>
<li><strong>PwCw</strong> – volumetric heat capacity of water (J/m3C)</li>
<li><strong>PsCs</strong> – volumetric heat capacity of solid (J/m3C)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pc the bulk volumetric heat capacity of the saturated medium (J/m3C)</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed using the equation:</p>
<div class="math notranslate nohighlight">
\[pc = n_e \cdot P_wC_w + (1 - n_e) \cdot P_sC_s\]</div>
</dd></dl>

<dl class="function">
<dt id="mylib.hydro_funcs.peclet">
<code class="descclassname">mylib.hydro_funcs.</code><code class="descname">peclet</code><span class="sig-paren">(</span><em>PwCw</em>, <em>q</em>, <em>L</em>, <em>ke</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.hydro_funcs.peclet" title="Permalink to this definition">¶</a></dt>
<dd><p>The Peclet number for heat transport. Note when Peclet number &lt; 0.5 dispersivity can be neglected (Rau et al. 2012).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>PwCw</strong> – volumetric heat capacity of water (J/m3C)</li>
<li><strong>q</strong> – groundwater flux (m/s, positive upward)</li>
<li><strong>L</strong> – length of flow path (m)</li>
<li><strong>ke</strong> – effective thermal conductivity (W/m C)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Ph the Peclet number for heat flow</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed with the equation:</p>
<div class="math notranslate nohighlight">
\[Ph = \frac{P_wC_w \cdot q \cdot L}{k_e}\]</div>
</dd></dl>

<dl class="function">
<dt id="mylib.hydro_funcs.vs_">
<code class="descclassname">mylib.hydro_funcs.</code><code class="descname">vs_</code><span class="sig-paren">(</span><em>q</em>, <em>ne</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.hydro_funcs.vs_" title="Permalink to this definition">¶</a></dt>
<dd><p>Solute Front Velocity</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>q</strong> – flux (m/s, positive downward)</li>
<li><strong>ne</strong> – effective porosity (unit-less)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">vs the solute front velocity (m/s)</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed with the equation:</p>
<div class="math notranslate nohighlight">
\[v_s = \frac{q}{n_w}\]</div>
</dd></dl>

<dl class="function">
<dt id="mylib.hydro_funcs.vt_">
<code class="descclassname">mylib.hydro_funcs.</code><code class="descname">vt_</code><span class="sig-paren">(</span><em>PwCw</em>, <em>vs</em>, <em>ne</em>, <em>pc</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.hydro_funcs.vt_" title="Permalink to this definition">¶</a></dt>
<dd><p>Thermal Front Velocity</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>PwCw</strong> – volumetric heat capacity of water (J/m3C)</li>
<li><strong>vs</strong> – solute front velocity (m/s)</li>
<li><strong>ne</strong> – effective porosity (unit-less)</li>
<li><strong>pc</strong> – bulk volumetric heat capacity of a saturated medium (J/m3C)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">vt the thermal front velocity</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed with the equation:</p>
<div class="math notranslate nohighlight">
\[v_t = v_s \cdot \frac{P_wC_w}{pc}\]</div>
</dd></dl>

<dl class="function">
<dt id="mylib.hydro_funcs.vt_full">
<code class="descclassname">mylib.hydro_funcs.</code><code class="descname">vt_full</code><span class="sig-paren">(</span><em>ne</em>, <em>PwCw</em>, <em>PsCs</em>, <em>q</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.hydro_funcs.vt_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the thermal front velocity without intermediately calculating the solute front velocity and bulk volumetric heat capacity of the saturated medium.</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ne</strong> – effective porosity (unit-less)</li>
<li><strong>PwCw</strong> – volumetric heat capacity of water (J/m3C)</li>
<li><strong>PsCs</strong> – volumetric heat capacity of solid (J/m3C)</li>
<li><strong>q</strong> – flux (m/s, positive downward)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">vt the thermal front velocity</p>
</td>
</tr>
</tbody>
</table>
<p>This is computed with the equations:</p>
<div class="math notranslate nohighlight">
\[pc = n_e \cdot P_wC_w + (1 - n_e) \cdot P_sC_s\]</div>
<div class="math notranslate nohighlight">
\[v_s = \frac{q}{n_w}\]</div>
<div class="math notranslate nohighlight">
\[v_t = v_s \cdot \frac{P_wC_w}{pc}\]</div>
</dd></dl>

</div>
<div class="section" id="module-mylib.plot">
<span id="mylib-plot-module"></span><h2>mylib.plot module<a class="headerlink" href="#module-mylib.plot" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mylib.plot.contour">
<code class="descclassname">mylib.plot.</code><code class="descname">contour</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z</em>, <em>xlab=''</em>, <em>ylab=''</em>, <em>cblab=''</em>, <em>size=(6</em>, <em>4)</em>, <em>save=False</em>, <em>fname=None</em>, <em>cmap='OrRd'</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.plot.contour" title="Permalink to this definition">¶</a></dt>
<dd><p>Grid three one dimensional numpy arrays of equal length and create a contour plot</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – A one dimensional numpy array</li>
<li><strong>y</strong> – A one dimensional numpy array</li>
<li><strong>z</strong> – A one dimensional numpy array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A contour plot.</p>
</td>
</tr>
</tbody>
</table>
<p>Kwargs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>xlab</strong> – A string x label (default= ‘’)</li>
<li><strong>ylab</strong> – A string x label (default= ‘’)</li>
<li><strong>figsize</strong> – figure size in tuple x, y in size inches (default = (6,4))</li>
<li><strong>marker</strong> – Show markers True or False (default = True)</li>
<li><strong>save</strong> – Save the figure True or False (default = False)</li>
<li><strong>fname</strong> – If save is True specify a filename (default = None)</li>
<li><strong>cmap</strong> – The colour map (default = “OrRd”)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mylib.plot.plot">
<code class="descclassname">mylib.plot.</code><code class="descname">plot</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>xlab=''</em>, <em>ylab=''</em>, <em>c='k'</em>, <em>figsize=(6</em>, <em>4)</em>, <em>marker=True</em>, <em>save=False</em>, <em>fname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.plot.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a x and y on a graph.</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – A list or array of values.</li>
<li><strong>y</strong> – A list or array of values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Kwargs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xlab</strong> – A string x label (default= ‘’)</li>
<li><strong>ylab</strong> – A string x label (default= ‘’)</li>
<li><strong>c</strong> – A string colour (default= ‘k’)</li>
<li><strong>figsize</strong> – figure size in tuple x, y in size inches (default = (6,4))</li>
<li><strong>marker</strong> – Show markers True or False (default = True)</li>
<li><strong>save</strong> – Save the figure True or False (default = False)</li>
<li><strong>fname</strong> – If save is True specify a filename (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Either shows a plot or saves a plot.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mylib.signal">
<span id="mylib-signal-module"></span><h2>mylib.signal module<a class="headerlink" href="#module-mylib.signal" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mylib.signal.filter_amp">
<code class="descclassname">mylib.signal.</code><code class="descname">filter_amp</code><span class="sig-paren">(</span><em>array</em>, <em>period=24</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.signal.filter_amp" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a zero centred sin wave and amplitudes from an amplitude modulated time-series</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array</strong> – A sinusoidal time series in the form of a 1D numpy array</td>
</tr>
</tbody>
</table>
<p>Kwargs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>period</strong> – The period for one oscillation (default = 24)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A list containing amplitudes for each cycle and a sine wave for the entire period.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<p>Create a sine wave:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(((</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Use the function to extract the amplitude:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">amp</span> <span class="o">=</span> <span class="n">filter_amp</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">period</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">amp</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="p">[</span><span class="mf">1.99316899</span><span class="p">]</span>
</pre></div>
</div>
<p>Or output the modelled sine wave:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">filter_amp</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">period</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Modelled&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mylib.signal.locate_minima">
<code class="descclassname">mylib.signal.</code><code class="descname">locate_minima</code><span class="sig-paren">(</span><em>array</em>, <em>period=24</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.signal.locate_minima" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the origin of the first wave period in an time series.</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array</strong> – A sinusoidal time series in the form of a 1D numpy array</td>
</tr>
</tbody>
</table>
<p>Kwargs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>period</strong> – The period for one ocillation (default = 24)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The index of the origin of the first oscillation.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mylib.stats">
<span id="mylib-stats-module"></span><h2>mylib.stats module<a class="headerlink" href="#module-mylib.stats" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mylib.stats.linear_eq">
<code class="descclassname">mylib.stats.</code><code class="descname">linear_eq</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.stats.linear_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the equation of a line.</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – The independent variable.</li>
<li><strong>y</strong> – The coefficient of determination.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A the function y = f(x), the slope, the intercept of the line and the R2 of the line to the original data.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mylib.stats.r2">
<code class="descclassname">mylib.stats.</code><code class="descname">r2</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.stats.r2" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an R2 value for two arrays of equal length.</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – The independent variable.</li>
<li><strong>y</strong> – The dependent variable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The coefficient of determination.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mylib.stats.reject_outliers">
<code class="descclassname">mylib.stats.</code><code class="descname">reject_outliers</code><span class="sig-paren">(</span><em>data</em>, <em>m=2</em><span class="sig-paren">)</span><a class="headerlink" href="#mylib.stats.reject_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject outliers from array.</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> – a numpy array.</li>
<li><strong>m</strong> – the number of  standard deviations from the median residual</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a array with outliers removed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mylib">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-mylib" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">mylib package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-mylib.heat_transport">mylib.heat_transport module</a></li>
<li><a class="reference internal" href="#module-mylib.hydro_funcs">mylib.hydro_funcs module</a></li>
<li><a class="reference internal" href="#module-mylib.plot">mylib.plot module</a></li>
<li><a class="reference internal" href="#module-mylib.signal">mylib.signal module</a></li>
<li><a class="reference internal" href="#module-mylib.stats">mylib.stats module</a></li>
<li><a class="reference internal" href="#module-mylib">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="modules.html"
                        title="previous chapter">mylib</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="license.html"
                        title="next chapter">License</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/mylib.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="license.html" title="License"
             >next</a> |</li>
        <li class="right" >
          <a href="modules.html" title="mylib"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mylib 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >mylib</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Robin Keegan-Treloar.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>